<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Travel LYKKE ‚Äì Voucher Generator</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial; max-width: 900px; margin: 32px auto;}
    fieldset{border:1px solid #ddd; padding:16px; border-radius:8px; margin-bottom:18px;}
    label{display:block; margin:8px 0 4px;}
    input, textarea{width:100%; padding:8px; border:1px solid #ccc; border-radius:6px;}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:16px;}
    button{background:#0E7AFE; color:#fff; padding:10px 14px; border:none; border-radius:6px; cursor:pointer;}
  </style>
</head>
<body>
  <h2>Travel LYKKE ‚Äì Voucher Generator (Template Injection + OpenAI)</h2>
  <form method="POST" enctype="multipart/form-data">
    <fieldset>
      <legend>1) Upload File</legend>
      <label>Master Excel (.xlsx) ‚Äì must include columns ‚ÄúParticular‚Äù, ‚ÄúFormatted Output‚Äù</label>
      <!-- üëá name MUST be 'file' to match app.py -->
      <input type="file" name="file" accept=".xlsx" required>
    </fieldset>

    <fieldset>
      <legend>2) Booking Details (optional; auto-fills if labels exist)</legend>
      <div class="grid">
        <div>
          <label>Confirmation ID</label>
          <input type="text" name="confirmation_id" placeholder="TLYK2025xxxxx">
        </div>
        <div>
          <label>Passenger / Guest Name</label>
          <input type="text" name="passenger_name" placeholder="Guest Name">
        </div>
      </div>
      <div class="grid">
        <div>
          <label>Start Date (for auto dates)</label>
          <input type="date" name="start_date">
        </div>
        <div>
          <label>Destination</label>
          <input type="text" name="destination" placeholder="Egypt">
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>3) Day-wise Itinerary</legend>
      <label>One line per day. Use ‚Äú+‚Äù to add multiple services in a day.</label>
      <textarea name="itinerary" rows="10" placeholder="Day 1: Arrival in Cairo + Airport Transfer
Day 2: Pyramids Day Tour + Sleeper Train Cairo to Aswan
Day 3: Aswan Highlights"></textarea>
    </fieldset>

    <button type="submit">Generate Voucher</button>
  </form>
</body>
</html>
